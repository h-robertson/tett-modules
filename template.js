var template=function(t){"use strict";var i="http://www.w3.org/1999/xhtml",r={svg:"http://www.w3.org/2000/svg",xhtml:i,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function o(t){var e=t+="",n=e.indexOf(":");return 0<=n&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),r.hasOwnProperty(e)?{space:r[e],local:t}:t}function a(t){t=o(t);return(t.local?function(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}:function(n){return function(){var t=this.ownerDocument,e=this.namespaceURI;return e===i&&t.documentElement.namespaceURI===i?t.createElement(n):t.createElementNS(e,n)}})(t)}function e(){}function h(t){return null==t?e:function(){return this.querySelector(t)}}function f(){return[]}function n(t){return new Array(t.length)}function p(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}p.prototype={constructor:p,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var g="$";function x(t,e,n,i,r,o){for(var a,s=0,l=e.length,u=o.length;s<u;++s)(a=e[s])?(a.__data__=o[s],i[s]=a):n[s]=new p(t,o[s]);for(;s<l;++s)(a=e[s])&&(r[s]=a)}function M(t,e,n,i,r,o,a){for(var s,l,u={},c=e.length,h=o.length,f=new Array(c),d=0;d<c;++d)(s=e[d])&&(f[d]=l=g+a.call(s,s.__data__,d,e),l in u?r[d]=s:u[l]=s);for(d=0;d<h;++d)(s=u[l=g+a.call(t,o[d],d,o)])?((i[d]=s).__data__=o[d],u[l]=null):n[d]=new p(t,o[d]);for(d=0;d<c;++d)(s=e[d])&&u[f[d]]===s&&(r[d]=s)}function d(t,e){return t<e?-1:e<t?1:e<=t?0:NaN}function s(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function l(t){return t.trim().split(/^|\s+/)}function u(t){return t.classList||new c(t)}function c(t){this._node=t,this._names=l(t.getAttribute("class")||"")}function _(t,e){for(var n=u(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function m(t,e){for(var n=u(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function y(){this.textContent=""}function v(){this.innerHTML=""}function w(){this.nextSibling&&this.parentNode.appendChild(this)}function b(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function k(){return null}function N(){var t=this.parentNode;t&&t.removeChild(this)}function A(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function S(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}c.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){t=this._names.indexOf(t);0<=t&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return 0<=this._names.indexOf(t)}};var z={},F=null;function L(n,t,e){return n=E(n,t,e),function(t){var e=t.relatedTarget;e&&(e===this||8&e.compareDocumentPosition(this))||n.call(this,t)}}function E(n,i,r){return function(t){var e=F;F=t;try{n.call(this,this.__data__,i,r)}finally{F=e}}}function T(o){return function(){var t=this.__on;if(t){for(var e,n=0,i=-1,r=t.length;n<r;++n)e=t[n],o.type&&e.type!==o.type||e.name!==o.name?t[++i]=e:this.removeEventListener(e.type,e.listener,e.capture);++i?t.length=i:delete this.__on}}}function C(l,u,c){var h=z.hasOwnProperty(l.type)?L:E;return function(t,e,n){var i,r=this.__on,o=h(u,e,n);if(r)for(var a=0,s=r.length;a<s;++a)if((i=r[a]).type===l.type&&i.name===l.name)return this.removeEventListener(i.type,i.listener,i.capture),this.addEventListener(i.type,i.listener=o,i.capture=c),void(i.value=u);this.addEventListener(l.type,o,c),i={type:l.type,name:l.name,value:u,listener:o,capture:c},r?r.push(i):this.__on=[i]}}function P(t,e,n){var i=s(t),r=i.CustomEvent;"function"==typeof r?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(z={mouseenter:"mouseover",mouseleave:"mouseout"}));var j=[null];function R(t,e){this._groups=t,this._parents=e}function q(t){return"string"==typeof t?new R([[document.querySelector(t)]],[document.documentElement]):new R([[t]],j)}function O(t,e){return t<e?-1:e<t?1:e<=t?0:NaN}R.prototype={constructor:R,select:function(t){"function"!=typeof t&&(t=h(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o,a,s=e[r],l=s.length,u=i[r]=new Array(l),c=0;c<l;++c)(o=s[c])&&(a=t.call(o,o.__data__,c,s))&&("__data__"in o&&(a.__data__=o.__data__),u[c]=a);return new R(i,this._parents)},selectAll:function(t){var e;"function"!=typeof t&&(t=null==(e=t)?f:function(){return this.querySelectorAll(e)});for(var n=this._groups,i=n.length,r=[],o=[],a=0;a<i;++a)for(var s,l=n[a],u=l.length,c=0;c<u;++c)(s=l[c])&&(r.push(t.call(s,s.__data__,c,l)),o.push(s));return new R(r,o)},filter:function(t){var e;"function"!=typeof t&&(e=t,t=function(){return this.matches(e)});for(var n=this._groups,i=n.length,r=new Array(i),o=0;o<i;++o)for(var a,s=n[o],l=s.length,u=r[o]=[],c=0;c<l;++c)(a=s[c])&&t.call(a,a.__data__,c,s)&&u.push(a);return new R(r,this._parents)},data:function(t,e){if(!t)return p=new Array(this.size()),c=-1,this.each(function(t){p[++c]=t}),p;var n,i=e?M:x,r=this._parents,o=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var a=o.length,s=new Array(a),l=new Array(a),u=new Array(a),c=0;c<a;++c){var h=r[c],f=o[c],d=f.length,p=t.call(h,h&&h.__data__,c,r),g=p.length,_=l[c]=new Array(g),m=s[c]=new Array(g);i(h,f,_,m,u[c]=new Array(d),p,e);for(var y,v,w=0,b=0;w<g;++w)if(y=_[w]){for(b<=w&&(b=w+1);!(v=m[b])&&++b<g;);y._next=v||null}}return(s=new R(s,r))._enter=l,s._exit=u,s},enter:function(){return new R(this._enter||this._groups.map(n),this._parents)},exit:function(){return new R(this._exit||this._groups.map(n),this._parents)},join:function(t,e,n){var i=this.enter(),r=this,o=this.exit(),i="function"==typeof t?t(i):i.append(t+"");return null!=e&&(r=e(r)),null==n?o.remove():n(o),i&&r?i.merge(r).order():r},merge:function(t){for(var e=this._groups,n=t._groups,i=e.length,t=n.length,r=Math.min(i,t),o=new Array(i),a=0;a<r;++a)for(var s,l=e[a],u=n[a],c=l.length,h=o[a]=new Array(c),f=0;f<c;++f)(s=l[f]||u[f])&&(h[f]=s);for(;a<i;++a)o[a]=e[a];return new R(o,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i,r=t[e],o=r.length-1,a=r[o];0<=--o;)(i=r[o])&&(a&&4^i.compareDocumentPosition(a)&&a.parentNode.insertBefore(i,a),a=i);return this},sort:function(n){function t(t,e){return t&&e?n(t.__data__,e.__data__):!t-!e}n=n||d;for(var e=this._groups,i=e.length,r=new Array(i),o=0;o<i;++o){for(var a,s=e[o],l=s.length,u=r[o]=new Array(l),c=0;c<l;++c)(a=s[c])&&(u[c]=a);u.sort(t)}return new R(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,o=i.length;r<o;++r){var a=i[r];if(a)return a}return null},size:function(){var t=0;return this.each(function(){++t}),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r,o=e[n],a=0,s=o.length;a<s;++a)(r=o[a])&&t.call(r,r.__data__,a,o);return this},attr:function(t,e){var n=o(t);if(arguments.length<2){t=this.node();return n.local?t.getAttributeNS(n.space,n.local):t.getAttribute(n)}return this.each((null==e?n.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}}:"function"==typeof e?n.local?function(e,n){return function(){var t=n.apply(this,arguments);null==t?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,t)}}:function(e,n){return function(){var t=n.apply(this,arguments);null==t?this.removeAttribute(e):this.setAttribute(e,t)}}:n.local?function(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}:function(t,e){return function(){this.setAttribute(t,e)}})(n,e))},style:function(t,e,n){return 1<arguments.length?this.each((null==e?function(t){return function(){this.style.removeProperty(t)}}:"function"==typeof e?function(e,n,i){return function(){var t=n.apply(this,arguments);null==t?this.style.removeProperty(e):this.style.setProperty(e,t,i)}}:function(t,e,n){return function(){this.style.setProperty(t,e,n)}})(t,e,null==n?"":n)):(n=this.node(),t=t,n.style.getPropertyValue(t)||s(n).getComputedStyle(n,null).getPropertyValue(t))},property:function(t,e){return 1<arguments.length?this.each((null==e?function(t){return function(){delete this[t]}}:"function"==typeof e?function(e,n){return function(){var t=n.apply(this,arguments);null==t?delete this[e]:this[e]=t}}:function(t,e){return function(){this[t]=e}})(t,e)):this.node()[t]},classed:function(t,e){var n=l(t+"");if(arguments.length<2){for(var i=u(this.node()),r=-1,o=n.length;++r<o;)if(!i.contains(n[r]))return!1;return!0}return this.each(("function"==typeof e?function(t,e){return function(){(e.apply(this,arguments)?_:m)(this,t)}}:e?function(t){return function(){_(this,t)}}:function(t){return function(){m(this,t)}})(n,e))},text:function(t){return arguments.length?this.each(null==t?y:("function"==typeof t?function(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}:function(t){return function(){this.textContent=t}})(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?v:("function"==typeof t?function(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}:function(t){return function(){this.innerHTML=t}})(t)):this.node().innerHTML},raise:function(){return this.each(w)},lower:function(){return this.each(b)},append:function(t){var e="function"==typeof t?t:a(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function(t,e){var n="function"==typeof t?t:a(t),i=null==e?k:"function"==typeof e?e:h(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})},remove:function(){return this.each(N)},clone:function(t){return this.select(t?S:A)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var i,r,o=(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return 0<=n&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}),a=o.length;if(!(arguments.length<2)){for(s=e?C:T,null==n&&(n=!1),i=0;i<a;++i)this.each(s(o[i],e,n));return this}var s=this.node().__on;if(s)for(var l,u=0,c=s.length;u<c;++u)for(i=0,l=s[u];i<a;++i)if((r=o[i]).type===l.type&&r.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?function(t,e){return function(){return P(this,t,e.apply(this,arguments))}}:function(t,e){return function(){return P(this,t,e)}})(t,e))}};var B,$,D=(1===(B=O).length&&($=B,B=function(t,e){return O($(t),e)}),{left:function(t,e,n,i){for(null==n&&(n=0),null==i&&(i=t.length);n<i;){var r=n+i>>>1;B(t[r],e)<0?n=1+r:i=r}return n},right:function(t,e,n,i){for(null==n&&(n=0),null==i&&(i=t.length);n<i;){var r=n+i>>>1;0<B(t[r],e)?i=r:n=1+r}return n}}).right,I=Math.sqrt(50),H=Math.sqrt(10),V=Math.sqrt(2);function U(t,e,n){t=(e-t)/Math.max(0,n),n=Math.floor(Math.log(t)/Math.LN10),t/=Math.pow(10,n);return 0<=n?(I<=t?10:H<=t?5:V<=t?2:1)*Math.pow(10,n):-Math.pow(10,-n)/(I<=t?10:H<=t?5:V<=t?2:1)}function X(t){return t.appendChild(this._container.node()),document.querySelector("#legend-styles")||((t=document.createElement("style")).id="legend-styles",t.type="text/css",t.innerHTML=".fl-legend-container.interactive .fl-legend-item:hover { opacity: 0.75; cursor: pointer; }",document.head.appendChild(t)),this}function W(t){return this._formatFunction=t,this}function G(){return this._container}function Y(t){return void 0===t?this._visible:(this._visible=t,this)}function Z(t){return void 0===t?this._auto_title:(this._auto_title=t,this)}function J(){var t=this,e="auto"==t._state.title_mode?t.autoTitle():t._state.title;this._container.select(".fl-legend-title").text(e).style("display",function(){return e.trim()?void 0===t._state.orientation||"horizontal"==t._state.orientation?"inline-block":"block":"none"})}function K(t){return t*parseFloat(getComputedStyle(document.documentElement).fontSize)}function Q(t){var e=Math.floor(Math.log(t)/Math.LN10),t=t/Math.pow(10,e),t=Math.floor(t)*Math.pow(10,e);return t=e<0?parseFloat(t.toFixed(-e)):t}var tt=Object.freeze({alignment:"start",orientation:"horizontal",text_color:null,title_weight:"bold",text_weight:"normal",text_size:1});function et(t){for(var e in this._state=t,tt)void 0===this._state[e]&&(this._state[e]=tt[e]);return this}et.prototype.appendTo=function(t){return this._container=q(t).append("div").node(),this},et.prototype.add=function(t){this._legends=Array.isArray(t)?t:[t];var e=this;return this._legends.forEach(function(t){t&&"function"==typeof t.appendTo?t.appendTo(e._container):console.warn("Please pass in valid legend instances into .add()")}),this},et.prototype.update=function(){this._legends.forEach(function(t){t&&"function"==typeof t.update&&t.update()});var t=this._state.text_size+"rem",e=.2*this._state.text_size+"rem",n=.5*this._state.text_size+"rem",i="horizontal"===this._state.orientation,r=this._state.alignment,o="center"==r?r:"flex-"+r;q(this._container).style("justify-content",i?o:null).style("align-items",i?null:o).style("display","flex").style("flex-direction",i?"row":"column").style("column-gap","1rem").style("row-gap","0.5rem"),q(this._container).selectAll(".fl-legend-container").style("justify-content",o).style("column-gap",n),q(this._container).selectAll(".fl-legend-title").style("color",this._state.text_color).style("font-weight",this._state.title_weight).style("font-size",t).style("margin-right",.25*t).style("line-height","1.25em").style("margin-top",0).style("margin-bottom",0).style("text-align",r),q(this._container).selectAll(".fl-legend-item").style("display","inline-flex").style("gap",e).style("text-align",r),q(this._container).selectAll(".fl-legend-label").style("color",this._state.text_color).style("font-weight",this._state.text_weight).style("font-size",t),q(this._container).selectAll(".label").style("color",this._state.text_color).style("font-weight",this._state.text_weight).style("margin","0 "+e).style("font-size",t);var n=window.template||void 0,r=n?n.state.layout:void 0,t=this._state.text_color||n&&r&&r.font_color||"#333333",n=r?r.body_font.name:window.getComputedStyle(document.body).fontFamily,r=K(this._state.text_size)+"px",a={fillStyle:t,font:this._state.text_weight+" "+r+" "+n},r=window.devicePixelRatio||1,n=Math.ceil(.95*K(this._state.text_size));return q(this._container).selectAll(".color-range-labels").style("margin-top",e).attr("height",n*r).style("height",n+"px").each(function(){q(this).datum(a)}),this};var nt=0,it=Object.freeze({show_legend:!0,title_mode:"auto",title:"",max_width:25,swatch_width:.75,swatch_height:1,swatch_radius:3,icon_height:1,icon_color:"#777777",order_override:"",orientation:"horizontal"});function rt(t){for(var e in this._state=t,it)void 0===this._state[e]&&(this._state[e]=it[e]);return this._colorFunction=void 0,this._formatFunction=void 0,this._legend_items=[],this._filtered_items=[],this._eventListeners=[],this._id="fl-legend-discrete-color-"+nt,this._visible=!0,this._auto_title="",this._container=q(document.createElement("div")).attr("class","fl-legend-container").attr("id",this._id),this._container.append("p").attr("class","fl-legend-title"),nt++,this}rt.prototype.appendTo=X,rt.prototype.format=W,rt.prototype.getContainer=G,rt.prototype.visible=Y,rt.prototype.autoTitle=Z,rt.prototype._updateTitle=J,rt.prototype.data=function(t,n){return this._colorFunction=n,t||n?(n?Array.isArray(t)?this._legend_items=t.slice().map(function(t,e){t="object"==typeof t?t.label||"":t;return t?{label:t,color:n(t),index:e}:null}).filter(function(t){return null!==t}):this._legend_items=[]:this._legend_items=Array.isArray(t)?t.slice():[],this):this._legend_items.slice()},rt.prototype.filtered=function(t){return t?(this._filtered_items=Array.isArray(t)?t.slice():[],this):this._filtered_items.slice()},rt.prototype.on=function(t,n){return this._container&&(n&&this._eventListeners.indexOf(t)<0?this._eventListeners.push(t):n||this._eventListeners.splice(this._eventListeners.indexOf[t],1),this._container.classed("interactive",0<this._eventListeners.length),n?this._container.on(t,function(){var t=F.target,e=t.parentNode,t=t.classList.contains("fl-legend-item")?t:e.classList.contains("fl-legend-item")?e:null;t&&(e=q(t).datum(),n.call(t,e,e.index))}):this._container.on(t,null)),this},rt.prototype.update=function(){var t=this._state.show_legend&&this._visible&&0<this._legend_items.length;return this._container.style("display",t?"":"none"),t&&(this._updateTitle(),this._updateLegend()),this},rt.prototype._updateLegend=function(){var i=this,e=this._formatFunction;this._container.style("max-width",K(this._state.max_width)+"px").style("display","inline-flex").style("flex-wrap","wrap").style("align-items","horizontal"==this._state.orientation?"center":"start").style("align-content","horizontal"==this._state.orientation?"center":null).style("flex-direction","horizontal"==this._state.orientation?null:"column");var t=this._state.order_override.trim()?function(t,e){for(var n={},i=e.split(/\s*\n\s*/),r=0;r<i.length;r++)n[i[r]]=r;for(var o=[],a=0;a<t.length;a++){var s=t[a],l=n[s.label];void 0!==l&&(o[l]=s)}return o.filter(function(t){return void 0!==t})}(this._legend_items,this._state.order_override):this._legend_items,n=this._container.selectAll(".fl-legend-item").data(t),t=n.enter().append("div").attr("class","fl-legend-item");t.append("div").attr("class","fl-legend-swatch"),t.append("svg").attr("class","fl-legend-icon").append("path"),t.append("p").attr("class","fl-legend-label");t=n.merge(t);return t.style("display","horizontal"==this._state.orientation?"inline-flex":"flex").style("opacity",function(t){return-1<i._filtered_items.indexOf(t.label)?.2:""}).style("align-items","center").style("column-gap","0.2rem"),t.select(".fl-legend-swatch").style("height",this._state.swatch_height+"rem").style("width",this._state.swatch_width+"rem").style("border-radius",this._state.swatch_radius+"px").style("background-color",function(t){return t.color}).style("display",function(t){return t.icon?"none":null}),t.select(".fl-legend-icon").attr("height",Math.ceil(K(this._state.icon_height))).attr("width",function(t){if(!t.icon)return 0;var e=t.icon.width,n=t.icon.height,t=t.outline?n*t.stroke_thickness:0,n=K(i._state.icon_height*((e+=t)/(n+=t)));return Math.ceil(n)}).style("margin-right",.25*this._state.text_size+"rem").style("display",function(t){return t.icon?"inline-block":"none"}).select("path").attr("d",function(t){return t.icon?t.icon.path_string:null}).attr("transform",function(t){if(!t.icon)return null;var e=t.icon.height,t=t.outline?e*t.stroke_thickness:0;e+=t;e="scale("+K(i._state.icon_height)/e+")";return e+="translate("+.5*t+","+.5*t+")"}).style("fill",function(t){return t.outline?"none":t.color||i._state.icon_color}).style("stroke",function(t){return t.outline?t.color||i._state.icon_color:"none"}).style("stroke-width",function(t){return t.outline?t.icon.height*t.stroke_thickness:0}),t.select(".fl-legend-label").text(function(t){return e?e(t.label):t.label}).style("margin",0).style("user-select","none"),n.exit().remove(),this._legend_item_els=t,this};var ot="$";function at(){}function st(t,e){var n=new at;if(t instanceof at)t.each(function(t,e){n.set(e,t)});else if(Array.isArray(t)){var i,r=-1,o=t.length;if(null==e)for(;++r<o;)n.set(r,t[r]);else for(;++r<o;)n.set(e(i=t[r],r,t),i)}else if(t)for(var a in t)n.set(a,t[a]);return n}at.prototype=st.prototype={constructor:at,has:function(t){return ot+t in this},get:function(t){return this[ot+t]},set:function(t,e){return this[ot+t]=e,this},remove:function(t){t=ot+t;return t in this&&delete this[t]},clear:function(){for(var t in this)t[0]===ot&&delete this[t]},keys:function(){var t,e=[];for(t in this)t[0]===ot&&e.push(t.slice(1));return e},values:function(){var t,e=[];for(t in this)t[0]===ot&&e.push(this[t]);return e},entries:function(){var t,e=[];for(t in this)t[0]===ot&&e.push({key:t.slice(1),value:this[t]});return e},size:function(){var t,e=0;for(t in this)t[0]===ot&&++e;return e},empty:function(){for(var t in this)if(t[0]===ot)return!1;return!0},each:function(t){for(var e in this)e[0]===ot&&t(this[e],e.slice(1),this)}};var lt=Array.prototype,ut=lt.map,ct=lt.slice;function ht(t,e,n){(t.prototype=e.prototype=n).constructor=t}function ft(t,e){var n,i=Object.create(t.prototype);for(n in e)i[n]=e[n];return i}function dt(){}var pt="\\s*([+-]?\\d+)\\s*",gt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",lt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",_t=/^#([0-9a-f]{3,8})$/,mt=new RegExp("^rgb\\("+[pt,pt,pt]+"\\)$"),yt=new RegExp("^rgb\\("+[lt,lt,lt]+"\\)$"),vt=new RegExp("^rgba\\("+[pt,pt,pt,gt]+"\\)$"),wt=new RegExp("^rgba\\("+[lt,lt,lt,gt]+"\\)$"),bt=new RegExp("^hsl\\("+[gt,lt,lt]+"\\)$"),xt=new RegExp("^hsla\\("+[gt,lt,lt,gt]+"\\)$"),Mt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function kt(){return this.rgb().formatHex()}function Nt(){return this.rgb().formatRgb()}function At(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=_t.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?St(e):3===n?new Lt(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?zt(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?zt(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=mt.exec(t))?new Lt(e[1],e[2],e[3],1):(e=yt.exec(t))?new Lt(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=vt.exec(t))?zt(e[1],e[2],e[3],e[4]):(e=wt.exec(t))?zt(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=bt.exec(t))?Pt(e[1],e[2]/100,e[3]/100,1):(e=xt.exec(t))?Pt(e[1],e[2]/100,e[3]/100,e[4]):Mt.hasOwnProperty(t)?St(Mt[t]):"transparent"===t?new Lt(NaN,NaN,NaN,0):null}function St(t){return new Lt(t>>16&255,t>>8&255,255&t,1)}function zt(t,e,n,i){return new Lt(t=i<=0?e=n=NaN:t,e,n,i)}function Ft(t,e,n,i){return 1===arguments.length?(r=(r=t)instanceof dt?r:At(r))?new Lt((r=r.rgb()).r,r.g,r.b,r.opacity):new Lt:new Lt(t,e,n,null==i?1:i);var r}function Lt(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function Et(){return"#"+Ct(this.r)+Ct(this.g)+Ct(this.b)}function Tt(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function Ct(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Pt(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||1<=n?t=e=NaN:e<=0&&(t=NaN),new Rt(t,e,n,i)}function jt(t){if(t instanceof Rt)return new Rt(t.h,t.s,t.l,t.opacity);if(!(t=!(t instanceof dt)?At(t):t))return new Rt;if(t instanceof Rt)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),o=Math.max(e,n,i),a=NaN,s=o-r,l=(o+r)/2;return s?(a=e===o?(n-i)/s+6*(n<i):n===o?(i-e)/s+2:(e-n)/s+4,s/=l<.5?o+r:2-o-r,a*=60):s=0<l&&l<1?0:a,new Rt(a,s,l,t.opacity)}function Rt(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function qt(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Ot(t){return function(){return t}}function Bt(o){return 1==(o=+o)?$t:function(t,e){return e-t?(n=t,i=e,r=o,n=Math.pow(n,r),i=Math.pow(i,r)-n,r=1/r,function(t){return Math.pow(n+t*i,r)}):Ot(isNaN(t)?e:t);var n,i,r}}function $t(t,e){var n,i,r=e-t;return r?(n=t,i=r,function(t){return n+t*i}):Ot(isNaN(t)?e:t)}ht(dt,At,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:kt,formatHex:kt,formatHsl:function(){return jt(this).formatHsl()},formatRgb:Nt,toString:Nt}),ht(Lt,Ft,ft(dt,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Lt(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Lt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Et,formatHex:Et,formatRgb:Tt,toString:Tt})),ht(Rt,function(t,e,n,i){return 1===arguments.length?jt(t):new Rt(t,e,n,null==i?1:i)},ft(dt,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Rt(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Rt(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,e=n+(n<.5?n:1-n)*e,n=2*n-e;return new Lt(qt(240<=t?t-240:120+t,n,e),qt(t,n,e),qt(t<120?240+t:t-120,n,e),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var Dt=function t(e){var a=Bt(e);function n(e,t){var n=a((e=Ft(e)).r,(t=Ft(t)).r),i=a(e.g,t.g),r=a(e.b,t.b),o=$t(e.opacity,t.opacity);return function(t){return e.r=n(t),e.g=i(t),e.b=r(t),e.opacity=o(t),e+""}}return n.gamma=t,n}(1);function It(e,n){return e=+e,n=+n,function(t){return e*(1-t)+n*t}}var Ht=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Vt=new RegExp(Ht.source,"g");function Ut(t,e){var n,i=typeof e;return null==e||"boolean"==i?Ot(e):("number"==i?It:"string"==i?(n=At(e))?(e=n,Dt):function(t,i){var e,n,r,o,a,s=Ht.lastIndex=Vt.lastIndex=0,l=-1,u=[],c=[];for(t+="",i+="";(e=Ht.exec(t))&&(n=Vt.exec(i));)(r=n.index)>s&&(r=i.slice(s,r),u[l]?u[l]+=r:u[++l]=r),(e=e[0])===(n=n[0])?u[l]?u[l]+=n:u[++l]=n:(u[++l]=null,c.push({i:l,x:It(e,n)})),s=Vt.lastIndex;return s<i.length&&(r=i.slice(s),u[l]?u[l]+=r:u[++l]=r),u.length<2?c[0]?(a=c[0].x,function(t){return a(t)+""}):(o=i,function(){return o}):(i=c.length,function(t){for(var e,n=0;n<i;++n)u[(e=c[n]).i]=e.x(t);return u.join("")})}:e instanceof At?Dt:e instanceof Date?function(e,n){var i=new Date;return e=+e,n=+n,function(t){return i.setTime(e*(1-t)+n*t),i}}:(n=e,!ArrayBuffer.isView(n)||n instanceof DataView?Array.isArray(e)?function(t,e){for(var n=e?e.length:0,i=t?Math.min(n,t.length):0,r=new Array(i),o=new Array(n),a=0;a<i;++a)r[a]=Ut(t[a],e[a]);for(;a<n;++a)o[a]=e[a];return function(t){for(a=0;a<i;++a)o[a]=r[a](t);return o}}:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?function(t,e){var n,i={},r={};for(n in null!==t&&"object"==typeof t||(t={}),e=null===e||"object"!=typeof e?{}:e)n in t?i[n]=Ut(t[n],e[n]):r[n]=e[n];return function(t){for(n in i)r[n]=i[n](t);return r}}:It:function(e,n){n=n||[];var i,r=e?Math.min(n.length,e.length):0,o=n.slice();return function(t){for(i=0;i<r;++i)o[i]=e[i]*(1-t)+n[i]*t;return o}}))(t,e)}function Xt(e,n){return e=+e,n=+n,function(t){return Math.round(e*(1-t)+n*t)}}function Wt(t){return+t}var Gt=[0,1];function Yt(t){return t}function Zt(e,n){return(n-=e=+e)?function(t){return(t-e)/n}:(t=isNaN(n)?NaN:.5,function(){return t});var t}function Jt(t){var e=t[0],n=t[t.length-1];return n<e&&(t=e,e=n,n=t),function(t){return Math.max(e,Math.min(n,t))}}function Kt(t,e,n){var i=t[0],t=t[1],r=e[0],e=e[1],r=t<i?(i=Zt(t,i),n(e,r)):(i=Zt(i,t),n(r,e));return function(t){return r(i(t))}}function Qt(n,t,e){var i=Math.min(n.length,t.length)-1,r=new Array(i),o=new Array(i),a=-1;for(n[i]<n[0]&&(n=n.slice().reverse(),t=t.slice().reverse());++a<i;)r[a]=Zt(n[a],n[a+1]),o[a]=e(t[a],t[a+1]);return function(t){var e=D(n,t,1,i)-1;return o[e](r[e](t))}}function te(t,e){return h=c=Gt,f=Ut,d=Yt,i.invert=function(t){return d(o((u=u||s(h,c.map(r),It))(t)))},i.domain=function(t){return arguments.length?(c=ut.call(t,Wt),d===Yt||(d=Jt(c)),n()):c.slice()},i.range=function(t){return arguments.length?(h=ct.call(t),n()):h.slice()},i.rangeRound=function(t){return h=ct.call(t),f=Xt,n()},i.clamp=function(t){return arguments.length?(d=t?Jt(c):Yt,i):d!==Yt},i.interpolate=function(t){return arguments.length?(f=t,n()):f},i.unknown=function(t){return arguments.length?(a=t,i):a},function(t,e){return r=t,o=e,n()}(t,e);function n(){return s=2<Math.min(c.length,h.length)?Qt:Kt,l=u=null,i}function i(t){return isNaN(t=+t)?a:(l=l||s(c.map(r),h,f))(r(d(t)))}var r,o,a,s,l,u,c,h,f,d}function ee(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,e=t.slice(0,n);return[1<e.length?e[0]+e.slice(2):e,+t.slice(n+1)]}function ne(t){return(t=ee(Math.abs(t)))?t[1]:NaN}var ie,re=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function oe(t){if(!(e=re.exec(t)))throw new Error("invalid format: "+t);var e;return new ae({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function ae(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function se(t,e){e=ee(t,e);if(!e)return t+"";t=e[0],e=e[1];return e<0?"0."+new Array(-e).join("0")+t:t.length>e+1?t.slice(0,e+1)+"."+t.slice(e+1):t+new Array(e-t.length+2).join("0")}oe.prototype=ae.prototype,ae.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var le={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return 1e21<=Math.abs(t=Math.round(t))?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return se(100*t,e)},r:se,s:function(t,e){if(!(i=ee(t,e)))return t+"";var n=i[0],i=(r=i[1])-(ie=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,r=n.length;return i===r?n:r<i?n+new Array(i-r+1).join("0"):0<i?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+ee(t,Math.max(0,e+i-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function ue(t){return t}var ce=Array.prototype.map,he=["y","z","a","f","p","n","Âµ","m","","k","M","G","T","P","E","Z","Y"];function fe(t){var e,s,l,x=void 0===t.grouping||void 0===t.thousands?ue:(s=ce.call(t.grouping,Number),l=t.thousands+"",function(t,e){for(var n=t.length,i=[],r=0,o=s[0],a=0;0<n&&0<o&&(e<a+o+1&&(o=Math.max(1,e-a)),i.push(t.substring(n-=o,n+o)),!((a+=o+1)>e));)o=s[r=(r+1)%s.length];return i.reverse().join(l)}),i=void 0===t.currency?"":t.currency[0]+"",r=void 0===t.currency?"":t.currency[1]+"",M=void 0===t.decimal?".":t.decimal+"",k=void 0===t.numerals?ue:(e=ce.call(t.numerals,String),function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}),o=void 0===t.percent?"%":t.percent+"",N=void 0===t.minus?"-":t.minus+"",A=void 0===t.nan?"NaN":t.nan+"";function a(t){var u=(t=oe(t)).fill,c=t.align,h=t.sign,e=t.symbol,f=t.zero,d=t.width,p=t.comma,g=t.precision,_=t.trim,m=t.type;"n"===m?(p=!0,m="g"):le[m]||(void 0===g&&(g=12),_=!0,m="g"),(f||"0"===u&&"="===c)&&(f=!0,u="0",c="=");var y="$"===e?i:"#"===e&&/[boxX]/.test(m)?"0"+m.toLowerCase():"",v="$"===e?r:/[%p]/.test(m)?o:"",w=le[m],b=/[defgprs%]/.test(m);function n(t){var e,n,i,r=y,o=v;if("c"===m)o=w(t)+o,t="";else{var a=(t=+t)<0||1/t<0;if(t=isNaN(t)?A:w(Math.abs(t),g),_&&(t=function(t){t:for(var e,n=t.length,i=1,r=-1;i<n;++i)switch(t[i]){case".":r=e=i;break;case"0":0===r&&(r=i),e=i;break;default:if(!+t[i])break t;0<r&&(r=0)}return 0<r?t.slice(0,r)+t.slice(e+1):t}(t)),r=((a=a&&0==+t&&"+"!==h?!1:a)?"("===h?h:N:"-"===h||"("===h?"":h)+r,o=("s"===m?he[8+ie/3]:"")+o+(a&&"("===h?")":""),b)for(e=-1,n=t.length;++e<n;)if((i=t.charCodeAt(e))<48||57<i){o=(46===i?M+t.slice(e+1):t.slice(e))+o,t=t.slice(0,e);break}}p&&!f&&(t=x(t,1/0));var s=r.length+t.length+o.length,l=s<d?new Array(d-s+1).join(u):"";switch(p&&f&&(t=x(l+t,l.length?d-o.length:1/0),l=""),c){case"<":t=r+t+o+l;break;case"=":t=r+l+t+o;break;case"^":t=l.slice(0,s=l.length>>1)+r+t+o+l.slice(s);break;default:t=l+r+t+o}return k(t)}return g=void 0===g?6:/[gprs]/.test(m)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),n.toString=function(){return t+""},n}return{format:a,formatPrefix:function(t,e){var n=a(((t=oe(t)).type="f",t)),e=3*Math.max(-8,Math.min(8,Math.floor(ne(e)/3))),i=Math.pow(10,-e),r=he[8+e/3];return function(t){return n(i*t)+r}}}}function de(t,e,n,i){var r,o,a,s,l,u=(o=t,a=e,s=n,n=Math.abs(a-o)/Math.max(0,s),s=Math.pow(10,Math.floor(Math.log(n)/Math.LN10)),I<=(n=n/s)?s*=10:H<=n?s*=5:V<=n&&(s*=2),a<o?-s:s);switch((i=oe(null==i?",f":i)).type){case"s":var c=Math.max(Math.abs(t),Math.abs(e));return null!=i.precision||isNaN((l=u,r=Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(ne(c)/3)))-ne(Math.abs(l)))))||(i.precision=r),ye(i,c);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN((l=u,c=Math.max(Math.abs(t),Math.abs(e)),l=Math.abs(l),c=Math.abs(c)-l,r=Math.max(0,ne(c)-ne(l))+1))||(i.precision=r-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(r=Math.max(0,-ne(Math.abs(u))))||(i.precision=r-2*("%"===i.type))}return me(i)}function pe(s){var l=s.domain;return s.ticks=function(t){var e=l();return function(t,e,n){var i,r,o,a,s=-1;if(n=+n,(t=+t)===(e=+e)&&0<n)return[t];if((i=e<t)&&(r=t,t=e,e=r),0===(a=U(t,e,n))||!isFinite(a))return[];if(0<a)for(t=Math.ceil(t/a),e=Math.floor(e/a),o=new Array(r=Math.ceil(e-t+1));++s<r;)o[s]=(t+s)*a;else for(t=Math.floor(t*a),e=Math.ceil(e*a),o=new Array(r=Math.ceil(t-e+1));++s<r;)o[s]=(t-s)/a;return i&&o.reverse(),o}(e[0],e[e.length-1],null==t?10:t)},s.tickFormat=function(t,e){var n=l();return de(n[0],n[n.length-1],null==t?10:t,e)},s.nice=function(t){null==t&&(t=10);var e,n=l(),i=0,r=n.length-1,o=n[i],a=n[r];return a<o&&(e=o,o=a,a=e,e=i,i=r,r=e),0<(e=U(o,a,t))?e=U(o=Math.floor(o/e)*e,a=Math.ceil(a/e)*e,t):e<0&&(e=U(o=Math.ceil(o*e)/e,a=Math.floor(a*e)/e,t)),0<e?(n[i]=Math.floor(o/e)*e,n[r]=Math.ceil(a/e)*e,l(n)):e<0&&(n[i]=Math.ceil(o*e)/e,n[r]=Math.floor(a*e)/e,l(n)),s},s}function ge(){var e=te(Yt,Yt);return e.copy=function(){return t=e,ge().domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown());var t},function(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}.apply(e,arguments),pe(e)}var _e,me=(_e=fe({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"})).format,ye=_e.formatPrefix,ve=0,we=window.devicePixelRatio||1,be=Object.freeze({show_legend:!0,title_mode:"auto",title:"",color_band_width:8,color_band_height:1,color_band_radius:3,binned_label_mode:"thresholds",binned_label_custom:"",legend_min:null,legend_max:null});function xe(t){for(var e in this._state=t,be)void 0===this._state[e]&&(this._state[e]=be[e]);return this._colorFunction=void 0,this._formatFunction=void 0,this._legend_domain=[],this._id="fl-legend-continuous-color-"+ve,this._visible=!0,this._marker_value=null,this._auto_title="",this._container=q(document.createElement("div")).attr("class","fl-legend-container").attr("id",this._id).style("display","none"),this._container.append("p").classed("fl-legend-title",!0),this._container.append("div").classed("min label",!0),this._container.append("div").classed("color-range-container",!0),this._container.select(".color-range-container").append("canvas").classed("color-range",!0),this._container.select(".color-range-container").append("canvas").classed("color-range-labels",!0),this._container.append("div").classed("max label",!0),ve++,this}function Me(t){var e,n=-1/0,i=1/0;for(e in t)n=Math.max(n,t[e]),i=Math.min(i,t[e]);return function(t){return i<=t&&t<=n}}xe.prototype.appendTo=X,xe.prototype.format=W,xe.prototype.getContainer=G,xe.prototype.visible=Y,xe.prototype.autoTitle=Z,xe.prototype._updateTitle=J,xe.prototype.data=function(t,e){if(!t&&!e)return this._legend_domain.slice();var n,i,r=Array.isArray(t)?t.slice():[];return this._legend_domain=(n=r,i=this._state,r=(t=n.sort(O))[0],n=t[t.length-1],t=2<t.length?t[1]:null,null===i.legend_min&&null===i.legend_max||(null!==i.legend_min&&null!==i.legend_max?i.legend_min<i.legend_max&&(r=i.legend_min,n=i.legend_max):null!==i.legend_min?n<(r=i.legend_min)&&(n=r+2):(n=i.legend_max)<r&&(r=n-2)),i=[r],null!==(t=null!==t&&(t<r||n<t)?null:t)&&i.push(t),i.push(n),i.min=r,i.max=n,i.mid=t,i),this._colorFunction=e,this},xe.prototype.markerValue=function(t){return void 0===t?this._marker_value:(this._marker_value=t,this)},xe.prototype.update=function(){var t=this._state.show_legend&&this._visible&&0<this._legend_domain.length;return this._container.style("display",t?"":"none"),t&&(this._updateTitle(),this._updateLegend()),this},xe.prototype._updateLegend=function(){var t=this._legend_domain;this._scale_type="continuous",this._colorFunction.thresholds?this._scale_type="binned":2<t.length&&(this._scale_type="diverging");var e=this._state,n=K(e.color_band_width),i=K(e.color_band_height),r=n;this._container.style("display","inline-flex").style("align-items","center"),this._container.select(".color-range-container").style("display","inline-block");e=this._container.select(".color-range").attr("width",n*we).attr("height",i*we).style("border-radius",e.color_band_radius+"px").style("width",n+"px").style("height",i+"px").style("display","block");this._container.select(".color-range-labels").attr("width",r*we).style("width",r+"px").style("display","continuous"==this._scale_type?"none":"block").node().getContext("2d").scale(we,we);var o=e.node().getContext("2d");o.scale(we,we);for(var a,s=0;s<n;s++){var l=this._colorFunction((a=s,t.min+a/n*(t.max-t.min)));o.fillStyle=l,o.strokeStyle=l,o.fillRect(s,0,1,i),o.strokeRect(s,0,1,i)}null!==this._marker_value&&(r=ge().domain([t.min,t.max]).range([0,n])(this.markerValue()),e=i,o.save(),o.strokeStyle="#FFFFFF",o.lineWidth=3,o.beginPath(),o.moveTo(r,0),o.lineTo(r,e),o.stroke(),o.strokeStyle="#000000",o.lineWidth=1,o.beginPath(),o.moveTo(r,0),o.lineTo(r,e),o.stroke(),o.restore()),this._updateLegendLabels()},xe.prototype._updateLegendLabels=function(){var t=this._container.select(".color-range-labels"),u=this._formatFunction,e=this._legend_domain,n=this._state;this._container.select(".min.label").style("display","continuous"==this._scale_type?"inline-block":"none").style("vertical-align","middle").style("user-select","none").style("line-height","1.25em").text(function(){return u?u(e.min):e.min}),this._container.select(".max.label").style("display","continuous"==this._scale_type?"inline-block":"none").style("vertical-align","middle").style("user-select","none").style("line-height","1.25em").text(function(){return u?u(e.max):e.max});var c,h,f,d,i=[],p=0,g=0;if("diverging"===this._scale_type?i=this._getDivergingLabels():"binned"===this._scale_type&&(i=this._getBinnedLabels()),i.length){var _=t.node().getContext("2d");_.textAlign="center",_.textBaseline="top";var r=(c=[],h=K(n.color_band_width),f=Me([0,h]),d=ge().domain([e.min,e.max]).range([0,h]),function(t){var e=d(t);if(f(e)){for(var n=u?u(t):t,i=_.measureText(n).width/2+1,r=e-i,o=e+i,a=0,s=c.length,l=0;l<s&&e>c[l].center;l++)a++;t=0===a,i=a===s;if(!(!t&&c[a-1].right>r||!i&&c[a].left<o))return t&&(p=Math.abs(Math.min(0,r))),i&&(g=Math.max(0,o-h)),c.splice(a,0,{left:r,center:e,right:o}),{text:n,position:e}}}),i=i.map(function(t){return r(t)}),n=K(n.color_band_width)+p+g;t.attr("width",n*we).style("width",n+"px"),q(".color-range").style("margin-left",p+"px"),_.scale(we,we),_.textAlign="center",_.textBaseline="top";var o,a=t.datum();for(o in a)_[o]=a[o];i.forEach(function(t){t&&_.fillText(t.text,t.position+p,0)})}},xe.prototype._getDivergingLabels=function(){var t=this._legend_domain,e=Me(t),n=[];return e(t.min)&&n.push(t.min),e(t.mid)&&n.push(t.mid),e(t.max)&&n.push(t.max),n},xe.prototype._getBinnedLabels=function(){var t,e,n=this._state,i=this._legend_domain,r=Me(i);return"thresholds"===n.binned_label_mode?(e=this._colorFunction.thresholds.slice().filter(r),i.min<e[0]&&e.unshift(i.min),i.max>e[e.length-i.length-1]&&e.unshift(i.max)):"centers"===n.binned_label_mode?(e=this._colorFunction.centers.slice().filter(r)).length?(r=(t=this._colorFunction.thresholds)[0],t=t[t.length-1],r>i.min&&e.unshift((i.min+r)/2),t<i.max&&e.unshift((t+i.max)/2)):e.push((i.min+i.max)/2):e=n.binned_label_custom.split(";").map(parseFloat),e};var ke=0,Ne=Object.freeze({show_legend:!0,title_mode:"auto",title:"",clip_height:1,small_circle_size:.5,shape_fill:"#eeeeee",shape_stroke:"#555555"});function Ae(t){for(var e in this._state=t,Ne)void 0===this._state[e]&&(this._state[e]=Ne[e]);this._scaleFunction=void 0,this._formatFunction=void 0,this._id="fl-legend-continuous-size-"+ke,this._visible=!0,this._auto_title="",this._container=q(document.createElement("div")).attr("class","fl-legend-container").attr("id",this._id).style("display","none").style("align-items","center"),this._container.append("p").attr("class","fl-legend-title"),this._container.append("div").classed("min label",!0);t=this._container.append("div").classed("circles",!0);return t.append("canvas").classed("min circle",!0),t.append("canvas").classed("max circle",!0),this._container.append("div").classed("max label",!0),ke++,this}Ae.prototype.appendTo=X,Ae.prototype.format=W,Ae.prototype.autoTitle=Z,Ae.prototype._updateTitle=J,Ae.prototype.getContainer=G,Ae.prototype.visible=Y,Ae.prototype.scale=function(t){return void 0===t?this._scaleFunction:(this._scaleFunction=t,this)},Ae.prototype.update=function(){var t=this._state.show_legend&&this._visible,e=Math.ceil(K(this._state.clip_height));return this._container.style("display",t?"inline-flex":"none").style("align-items","center").style("min-height",e+"px"),t&&this._scaleFunction&&(0!==this._scaleFunction.domain()[0]&&console.warn("Non zero domain[0] in ContinuousSizeLegend"),0!==this._scaleFunction.range()[0]&&console.warn("Non zero range[0] in ContinuousSizeLegend"),this._updateTitle(),this._updateLegend()),this},Ae.prototype._updateLegend=function(){var t=this._scaleFunction.domain(),e=this._scaleFunction.range(),n=this._formatFunction,i=this._state,r=K(i.clip_height),r=Math.ceil(Math.min(r,2*e[1])),o=window.devicePixelRatio||1,a=i.shape_fill,s=i.shape_stroke;this._container.style("min-height",r+"px"),this._container.select(".circles").style("display","flex").style("flex-wrap","nowrap");var e=this._scaleFunction.invert(r/2),l=Q(e=Math.min(e,t[1]))||0,u=l*i.small_circle_size,t=this._scaleFunction(u),e=Math.ceil(2*t)+2,i=this._container.select(".min.circle").style("width",e+"px").style("height",r+"px").attr("width",e*o).attr("height",r*o).style("margin-right","0.05rem");this._container.select(".min.label").style("user-select","none").style("line-height","1.25em").text(function(){return n?n(u):u});i=i.node().getContext("2d");i.scale(o,o),i.fillStyle=a,i.clearRect(0,0,2*t,2*t),i.beginPath(),i.fillStyle=s,i.arc(.5*e,.5*r,t,0,2*Math.PI),i.fill(),i.beginPath(),i.fillStyle=a,i.arc(.5*e,.5*r,Math.max(t-1,0),0,2*Math.PI),i.fill();e=this._scaleFunction(l),t=Math.ceil(2*e)+2,i=this._container.select(".max.circle").style("width",t+"px").style("height",r+"px").attr("width",t*o).attr("height",r*o).style("margin-left","0.05rem");this._container.select(".max.label").style("user-select","none").style("line-height","1.25em").text(function(){return n?n(l):l});i=i.node().getContext("2d");i.scale(o,o),i.clearRect(0,0,2*e,2*e),i.beginPath(),i.fillStyle=s,i.arc(.5*t,.5*r,e,0,2*Math.PI),i.fill(),i.beginPath(),i.fillStyle=a,i.arc(.5*t,.5*r,Math.max(e-1,0),0,2*Math.PI),i.fill()};var Se={legend_container:{},legend_categorical:{},legend_continuous:{},legend_size:{}};const ze=new et(Se.legend_container),Fe=new rt(Se.legend_categorical),Le=new xe(Se.legend_continuous),Ee=new Ae(Se.legend_size);function Te(){Fe.data([{label:"Brazil",color:"#ff0000"},{label:"Argentina",color:"#000000"}]);Le.data([{label:10,color:"#ff0000"},{label:0,color:"#000000"}]),ze.update()}return t.data={},t.draw=function(){ze.appendTo(document.getElementById("legend")).add([Fe,Le,Ee]),Te()},t.state=Se,t.update=Te,t}({});
//# sourceMappingURL=template.js.map
